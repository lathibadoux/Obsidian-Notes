## ==Question:==

Write a solution to find the percentage of the users registered in each contest rounded to **two decimals**.

Return the result table ordered by `percentage` in **descending order**. In case of a tie, order it by `contest_id` in **ascending order**.

The result format is in the following example.

**Example 1:**

**Input:** 
Users table:
+---------+-----------+
| user_id | user_name |
+---------+-----------+
| 6       | Alice     |
| 2       | Bob       |
| 7       | Alex      |
+---------+-----------+
Register table:
+------------+---------+
| contest_id | user_id |
+------------+---------+
| 215        | 6       |
| 209        | 2       |
| 208        | 2       |
| 210        | 6       |
| 208        | 6       |
| 209        | 7       |
| 209        | 6       |
| 215        | 7       |
| 208        | 7       |
| 210        | 2       |
| 207        | 2       |
| 210        | 7       |
+------------+---------+
**Output:** 
+------------+------------+
| contest_id | percentage |
+------------+------------+
| 208        | 100.0      |
| 209        | 100.0      |
| 210        | 100.0      |
| 215        | 66.67      |
| 207        | 33.33      |
+------------+------------+

## ==Answer:==

### Best Performance:

```sql
DECLARE @total_users int = (SELECT COUNT(*) FROM dbo.Users);

SELECT
  r.contest_id,
  ROUND(100.0 * COUNT(*) / @total_users, 2) AS percentage
FROM dbo.Register AS r
GROUP BY r.contest_id
ORDER BY percentage DESC, r.contest_id ASC;
```

* The “faster” query avoids an unnecessary cross join/derived table and lets the optimizer compute the users count once as a constant, so it pushes fewer rows through fewer operators.

### Another Option:

```sql
select contest_id, 
round(cast((user_contest_count/user_total_count)*100 as float),2) as percentage from ( 
	select contest_id
	, count(r.user_id) as user_contest_count
	, user_total_count 
	from Register as r 
	cross join ( 
		select count(user_id) as user_total_count from Users 
	) as u 
	group by contest_id 
) as temp 
order by percentage desc, contest_id asc
```

* Carrying `user_total_count` through the subquery result increases row width in the pipeline. The simpler query keeps rows skinny until the very end.