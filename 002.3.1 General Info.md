* Slowly changing dimensions have a time frame associated with them.
* If modeled incorrectly, an SCD can produce Idempotency.
	* ==Idempotency== is the ability for you pipeline to produce the same results whether it is running in production or running in backfill.
	* Idempotent denotes an element of a set which is unchanged in value when multiplied or otherwise operated on by itself.
	* Production and backfill are the same.
* What can make a pipeline ==not== idempotent:
	1. INSERT INTO without TRUNCATE
		* Use MERGE or INSERT OVERWRITE every time please
		* Generally speaking never use INSERT INTO (especially without TRUNCATE)
	2. Using start_date > without a corresponding end_date <
		* Looking at using a window to process the data in a set time frame (i.e. I want to process 6 days of data, I want to process one month of data, etc.)
	3. Not using a full set of partition sensors
		* Pipeline might run too early when there is no/partial data
		* Your backfill and production runs of the data do not produce the same results
	4. Not using depends_on_past for cumulative pipelines (i.e. sequential processing)
	5. Relying on the "latest" partition of a not properly modeled SCD table
		* Sometimes you use today's data, but if not available you use yesterday's data
		* Improved data latency is at the cost of data quality
		* Cumulative table design AMPLIFIES this bug because it carries the incorrect information forward every day
		* One exception is if you're backfilling data (not production) and have a properly modeled SCD table
	6. Relying on the "latest" partition of anything else
* The pains of not having idempotent pipelines
	1. Backfilling causes inconsistencies between the old and restated data
	2. Very hard to troubleshoot bugs
	3. Unit testing cannot replicate the production behavior
	4. Silent failures (don't know it's wrong until an analyst yells at you for data that won't reconcile)
* Should you model as a slowly changing dimension?
	* The more slowly changing it is the better.  That's where you get the most efficiency gain.
	* What are the options?
		1. Singular latest snapshot
			*  Be careful since these are not idempotent
		2. Daily/Monthly/Yearly partitioned snapshot
		3. SCD (only records the changes in the snapshots)
			* Type 0 - aren't actually slowly changed (i.e. birth date)
			* Type 1 - you only care about the latest value
				* Never use this type because it makes your pipelines not idempotent anymore
			* ==Type 2 - you only care about what the value was from "start_date" to "end_date"==
				* Current values usually have either an end_date that is:
					* NULL
					* Far into the future like 9999-12-31
				* May have a boolean value column called "Is_Current"
				* Hard to use:
					* Since there's more than 1 row per dimension, you need to be careful about filtering on time
				* Zach's favorite type of SCD
					* The ONLY type of SCD that is purely idempotent
			* Type 3 - you only care about the "original" and "current" values
				* Benefits
					* you only have 1 row per dimension
				* Drawbacks
					* you lose the history in between original and  current
				* Is this idempotent?
					* Partially, which means it's not